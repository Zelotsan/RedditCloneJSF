<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough">
<h:body>
    <ui:composition template="/template/layout.xhtml">
        <ui:define name="content">
            <div class="page-header" id="banner">
                <div class="row">
                    <div class="col-xs-12">
                        <h1>Herzlich willkommen bei RedditClone</h1>
                        <p>
                        	The community is waiting for it!
                        </p>
                        <h:panelGroup layout="block" rendered="#{userManager.loggedIn}">
                        	<b:button value="Submit new Link" look="success" p:data-target="#linkModal" p:data-toggle="modal" onclick="return false;" size="sm"/>
		                	<b:modal id="linkModal" title="Submit new link">
								<h:form><table class="table borderless">
									<tbody>
										<tr>
											<td>
												<h:outputText value="Titel: "></h:outputText>
											</td>
											<td>
												<b:inputText placeholder="Titel.." id="mtitle"  fieldSize="sm" value="#{feed.title}"/>
											</td>
										</tr>
										<tr>
											<td>
												<h:outputText value="Link: "></h:outputText>
											</td>
											<td>
												<b:inputText placeholder="http://www.beispiel.ch" id="mlink" fieldSize="sm" value="#{feed.link}"/>
											</td>
										</tr>
									</tbody>
								</table>
								<b:commandButton value="Submit new link" look="primary" dismiss="modal" action="#{feed.addPost()}"/>
								<b:button value="Close" dismiss="modal" onclick="return false;"/>
							
								</h:form>
							</b:modal>
							</h:panelGroup>
					<p>	
							<h:panelGroup id="posts">
									<ul class="media-list list-group">
										<ui:repeat var="post" value="#{feed.posts}">
											<li class="media list-group-item">
												<div class="pull-left col-xs-1">
													<h:form rendered="#{userManager.loggedIn}">
															<h:commandLink class="pull-left" action="#{post.vote(1)}">
																<f:actionListener binding="#{feed.save()}" />
																<span class="glyphicon glyphicon-chevron-up"></span>
															</h:commandLink>
															<div class="clearfix"></div>
															#{post.vote}
															<div class="clearfix"></div>
															<h:commandLink class="pull-left" action="#{post.vote(-1)}">
																<span class="glyphicon glyphicon-chevron-down"></span>
															</h:commandLink>
														
													</h:form>
												</div>
												<div class="media-body">
													<a href="#{post.link}"><h4>#{post.title}</h4></a>
													submitted #{post.getTimeDifference()} by #{post.username}.
												</div>
											</li>
										</ui:repeat>
									</ul>
							<h:messages style="color:red" />
						</h:panelGroup>
					</p>
                    </div>
                </div>
            </div>
        </ui:define>
    </ui:composition>
</h:body>
</html>